<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Verb Learning Adventure</title>
    <link rel="stylesheet" href="src/css/style.css" />
  </head>
  <body>
    <div class="app-container">
      <!-- Student Login Screen -->
      <div id="login-screen" class="screen active">
        <div class="login-content">
          <h1 class="login-title">🎓 欢迎来到动词学习中心</h1>
          <p class="login-subtitle">请输入你的学生ID开始学习之旅</p>

          <div class="login-form">
            <div class="input-group">
              <label for="student-id-input" class="input-label">学生ID：</label>
              <input
                type="text"
                id="student-id-input"
                class="form-control login-input"
                placeholder="输入你的姓名或学号"
                maxlength="20"
              />
            </div>

            <button class="btn btn--primary btn--large" id="login-btn">
              🚀 开始学习
            </button>

            <div class="login-options">
              <p class="login-help">第一次使用？输入你的姓名创建新档案</p>

              <div
                class="existing-students"
                id="existing-students"
                style="display: none"
              >
                <h4>选择已有档案：</h4>
                <div class="student-list" id="student-list">
                  <!-- 动态生成学生列表 -->
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Welcome Screen -->
      <div id="welcome-screen" class="screen">
        <div class="welcome-content">
          <div class="student-info">
            <span class="current-student"
              >👨‍🎓 当前学生: <span id="current-student-display"></span
            ></span>
            <button class="btn btn--outline btn--sm" id="switch-student-btn">
              切换学生
            </button>
          </div>

          <h1 class="welcome-title">🌟 Verb Learning Adventure 🌟</h1>
          <p class="welcome-subtitle">
            Learn verb forms in a fun and easy way!
          </p>
          <div class="mode-buttons">
            <button
              class="btn btn--primary btn--large mode-btn"
              data-mode="learn"
            >
              📚 Learn Mode
              <span class="mode-description"
                >Discover new verbs with examples</span
              >
            </button>
            <button
              class="btn btn--primary btn--large mode-btn"
              data-mode="practice"
            >
              🎯 Practice Mode
              <span class="mode-description"
                >Interactive games and exercises</span
              >
            </button>
            <button
              class="btn btn--primary btn--large mode-btn"
              data-mode="challenge"
            >
              🏆 Challenge Mode
              <span class="mode-description">Test your knowledge</span>
            </button>
          </div>
          <div class="settings-section">
            <button class="btn btn--outline settings-btn" id="settings-btn">
              ⚙️ Settings
            </button>
          </div>
        </div>
      </div>

      <!-- Settings Screen -->
      <div id="settings-screen" class="screen">
        <div class="settings-content">
          <h2>Settings</h2>
          <div class="setting-group">
            <label class="form-label">Speech Speed:</label>
            <select id="speech-speed" class="form-control">
              <option value="0.7">Slow</option>
              <option value="1" selected>Normal</option>
              <option value="1.3">Fast</option>
            </select>
          </div>
          <div class="setting-group">
            <label class="form-label">Voice Volume:</label>
            <input
              type="range"
              id="voice-volume"
              class="volume-slider"
              min="0"
              max="1"
              step="0.1"
              value="0.8"
            />
          </div>
          <div class="setting-group">
            <label class="form-label">
              <input type="checkbox" id="auto-play-audio" checked /> Auto-play
              audio
            </label>
          </div>

          <!-- 学生账户管理部分 -->
          <div class="setting-group">
            <h3>👨‍🎓 学生账户</h3>
            <div class="account-info">
              <p>当前登录: <span id="settings-current-student"></span></p>
              <div class="account-buttons">
                <button class="btn btn--outline" id="logout-btn">
                  🚪 切换/注销学生
                </button>
              </div>
            </div>
          </div>

          <!-- 成绩管理部分 -->
          <div class="setting-group">
            <h3>📊 学习成绩管理</h3>
            <div class="score-buttons">
              <button class="btn btn--secondary" id="view-scores">
                📈 查看成绩统计
              </button>
              <button class="btn btn--secondary" id="export-scores">
                📤 导出成绩
              </button>
              <button class="btn btn--secondary" id="import-scores">
                📥 导入成绩
              </button>
              <input
                type="file"
                id="score-file-input"
                accept=".json"
                style="display: none"
              />
            </div>
          </div>

          <button class="btn btn--outline back-btn" id="back-to-welcome">
            Back to Main Menu
          </button>
        </div>
      </div>

      <!-- 成绩统计页面 -->
      <div id="scores-screen" class="screen">
        <div class="scores-content">
          <div class="scores-header">
            <button class="btn btn--outline back-btn" id="scores-back">
              ← 返回设置
            </button>
            <h2>📊 学习成绩统计</h2>
          </div>

          <div class="stats-container">
            <div class="overall-stats">
              <h3>📈 总体统计</h3>
              <div class="stats-grid">
                <div class="stat-card">
                  <div class="stat-value" id="total-sessions">0</div>
                  <div class="stat-label">练习次数</div>
                </div>
                <div class="stat-card">
                  <div class="stat-value" id="average-score">0</div>
                  <div class="stat-label">平均分数</div>
                </div>
                <div class="stat-card">
                  <div class="stat-value" id="best-score">0</div>
                  <div class="stat-label">最高分数</div>
                </div>
                <div class="stat-card">
                  <div class="stat-value" id="activities-completed">0</div>
                  <div class="stat-label">活动类型</div>
                </div>
              </div>
            </div>

            <div class="activity-stats">
              <h3>🎯 分项成绩</h3>
              <div class="activity-list" id="activity-stats-list">
                <!-- 动态生成 -->
              </div>
            </div>

            <div class="recommendations">
              <h3>💡 学习建议</h3>
              <div class="recommendations-list" id="recommendations-list">
                <!-- 动态生成 -->
              </div>
            </div>

            <div class="recent-sessions">
              <h3>📅 最近练习</h3>
              <div class="sessions-list" id="recent-sessions-list">
                <!-- 动态生成 -->
              </div>
            </div>
          </div>
        </div>
      </div>

      <!-- Learn Mode Screen -->
      <div id="learn-screen" class="screen">
        <div class="learn-header">
          <button class="btn btn--outline back-btn" id="learn-back">
            ← Back
          </button>
          <div class="progress-info">
            <span class="progress-text"
              >Verb <span id="learn-current">1</span> of
              <span id="learn-total"></span
            ></span>
            <div class="progress-bar">
              <div class="progress-fill" id="learn-progress"></div>
            </div>
          </div>
        </div>
        <div class="learn-content">
          <div class="verb-card">
            <div class="verb-main">
              <h2 class="verb-infinitive" id="current-infinitive">go</h2>
              <button class="btn btn--secondary audio-btn" id="play-infinitive">
                🔊 Listen
              </button>
            </div>
            <div class="verb-past">
              <h3>Past Form:</h3>
              <span class="past-form" id="current-past">went</span>
              <button class="btn btn--secondary audio-btn" id="play-past">
                🔊 Listen
              </button>
            </div>
            <div class="verb-definition">
              <h3>Meaning:</h3>
              <p id="current-definition">to move from one place to another</p>
              <button class="btn btn--secondary audio-btn" id="play-definition">
                🔊 Listen
              </button>
            </div>
            <div class="verb-examples">
              <div class="example-present">
                <h4>Present Example:</h4>
                <p id="current-example">I go to school every day.</p>
                <button class="btn btn--secondary audio-btn" id="play-example">
                  🔊 Listen
                </button>
              </div>
              <div class="example-past">
                <h4>Past Example:</h4>
                <p id="current-past-example">Yesterday, I went to the park.</p>
                <button
                  class="btn btn--secondary audio-btn"
                  id="play-past-example"
                >
                  🔊 Listen
                </button>
              </div>
            </div>
          </div>
          <div class="navigation-buttons">
            <button class="btn btn--outline nav-btn" id="prev-verb" disabled>
              ← Previous
            </button>
            <button class="btn btn--primary nav-btn" id="next-verb">
              Next →
            </button>
          </div>
        </div>
      </div>

      <!-- Practice Mode Screen -->
      <div id="practice-screen" class="screen">
        <div class="practice-header">
          <button class="btn btn--outline back-btn" id="practice-back">
            ← Back
          </button>
          <div class="score-info">
            <span class="score">Score: <span id="current-score">0</span></span>
            <span class="streak"
              >Streak: <span id="current-streak">0</span></span
            >
          </div>
        </div>
        <div class="practice-content">
          <div class="activity-selector">
            <button
              class="btn btn--primary activity-btn"
              data-activity="matching"
            >
              🎯 Matching Game
            </button>
            <button
              class="btn btn--primary activity-btn"
              data-activity="fill-blank"
            >
              📝 Fill the Blank
            </button>
            <button
              class="btn btn--primary activity-btn"
              data-activity="letter-choice"
            >
              🔤 Letter Choice
            </button>
            <button
              class="btn btn--primary activity-btn"
              data-activity="pronunciation"
            >
              🎤 Pronunciation Practice
            </button>
          </div>

          <!-- Matching Game -->
          <div id="matching-game" class="activity hidden">
            <h3>Match the verbs with their past forms!</h3>
            <div class="matching-container">
              <div class="infinitive-column">
                <h4>Present Form</h4>
                <div id="infinitive-cards"></div>
              </div>
              <div class="past-column">
                <h4>Past Form</h4>
                <div id="past-cards"></div>
              </div>
            </div>
            <button class="btn btn--primary" id="check-matches">
              Check Answers
            </button>
          </div>

          <!-- Fill in the Blank -->
          <div id="fill-blank-game" class="activity hidden">
            <div class="game-scene">
              <div class="sky-section">
                <div class="sun">🌞</div>
                <div class="clouds">☁️ ☁️</div>
              </div>

              <div class="game-content">
                <h3 class="game-title">🌳 Word Garden Challenge! 🌳</h3>

                <div class="question-container">
                  <p class="question-text" id="blank-question">
                    Yesterday, I _____ to the park.
                  </p>
                  <div class="hint-text" id="hint-text">
                    (Hint: past form of "go")
                  </div>
                </div>

                <div class="letters-container">
                  <h4 class="letters-title">🔤 Use these letters:</h4>
                  <div class="letter-bubbles" id="letter-bubbles">
                    <!-- Letter bubbles will be generated here -->
                  </div>
                </div>

                <div class="answer-area">
                  <div class="answer-slots" id="answer-slots">
                    <!-- Answer slots will be generated here -->
                  </div>
                  <button
                    class="btn btn--primary submit-btn"
                    id="submit-answer"
                  >
                    ✅ Check Answer
                  </button>
                </div>

                <div class="game-controls">
                  <button class="btn btn--secondary" id="hear-question">
                    🔊 Listen
                  </button>
                  <button class="btn btn--outline" id="clear-answer">
                    🗑️ Clear
                  </button>
                </div>
              </div>

              <div class="ground-section">
                <div class="flowers">🌸 🌼 🌸 🌼 🌸</div>
              </div>
            </div>
            <div class="feedback" id="answer-feedback"></div>
          </div>

          <!-- Letter Choice -->
          <div id="letter-choice-game" class="activity hidden">
            <div class="game-scene">
              <div class="sky-section">
                <div class="sun">🌞</div>
                <div class="clouds">☁️ ☁️</div>
              </div>

              <div class="game-content">
                <h3 class="game-title">🔤 Letter Detective! 🔤</h3>

                <div class="question-container">
                  <p class="question-text" id="letter-choice-question">
                    Yesterday, I went to the park.
                  </p>
                  <div class="hint-text" id="letter-choice-hint">
                    (Hint: past form of "go")
                  </div>
                </div>

                <div class="word-display">
                  <h4 class="word-title">Complete the word:</h4>
                  <div class="word-letters" id="word-letters">
                    <!-- Word letters with blank will be generated here -->
                  </div>
                </div>

                <div class="choices-area">
                  <h4 class="choices-title">Choose the missing letter:</h4>
                  <div class="letter-choices" id="letter-choices">
                    <!-- Letter choice buttons will be generated here -->
                  </div>
                </div>

                <div class="game-controls">
                  <button class="btn btn--secondary" id="hear-letter-question">
                    🔊 Listen
                  </button>
                  <button class="btn btn--outline" id="next-letter-word">
                    🔄 New Word
                  </button>
                </div>
              </div>

              <div class="ground-section">
                <div class="flowers">🌸 🌼 🌸 🌼 🌸</div>
              </div>
            </div>
            <div class="feedback" id="letter-choice-feedback"></div>
          </div>

          <!-- Pronunciation Practice -->
          <div id="pronunciation-game" class="activity hidden">
            <h3>Practice saying the verb correctly!</h3>
            <div class="pronunciation-container">
              <div class="target-word">
                <h4>Say this word:</h4>
                <span class="word-to-say" id="target-pronunciation">went</span>
                <button class="btn btn--secondary" id="play-target-word">
                  🔊 Listen
                </button>
              </div>
              <div class="recording-controls">
                <button
                  class="btn btn--primary recording-btn"
                  id="start-recording"
                >
                  🎤 Start Recording
                </button>
                <button
                  class="btn btn--outline recording-btn"
                  id="stop-recording"
                  disabled
                >
                  ⏹️ Stop
                </button>
              </div>
              <div class="recording-feedback" id="pronunciation-feedback"></div>
            </div>
          </div>
        </div>
      </div>

      <!-- Challenge Mode Screen -->
      <div id="challenge-screen" class="screen">
        <div class="challenge-header">
          <button class="btn btn--outline back-btn" id="challenge-back">
            ← Back
          </button>
          <div class="challenge-info">
            <span class="question-number"
              >Question <span id="challenge-current">1</span> of
              <span id="challenge-total"></span
            ></span>
            <span class="challenge-score"
              >Score: <span id="challenge-score">0</span></span
            >
          </div>
        </div>
        <div class="challenge-content">
          <div class="challenge-question">
            <h3 id="challenge-question-text">What is the past form of "go"?</h3>
            <div class="challenge-options" id="challenge-options">
              <button class="btn btn--outline option-btn" data-answer="went">
                went
              </button>
              <button class="btn btn--outline option-btn" data-answer="goes">
                goes
              </button>
              <button class="btn btn--outline option-btn" data-answer="gone">
                gone
              </button>
              <button class="btn btn--outline option-btn" data-answer="going">
                going
              </button>
            </div>
          </div>
          <div class="challenge-feedback" id="challenge-feedback"></div>
          <button class="btn btn--primary hidden" id="next-challenge">
            Next Question
          </button>
          <button class="btn btn--primary hidden" id="finish-challenge">
            Finish Challenge
          </button>
        </div>
      </div>

      <!-- Results Screen -->
      <div id="results-screen" class="screen">
        <div class="results-content">
          <h2>🎉 Great Job! 🎉</h2>
          <div class="final-score">
            <p>Your Final Score: <span id="final-score">0</span></p>
            <div class="achievements" id="achievements"></div>
          </div>
          <div class="results-buttons">
            <button class="btn btn--primary" id="play-again">Play Again</button>
            <button class="btn btn--outline back-btn" id="back-to-menu">
              Back to Menu
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>

    <script src="src/js/scoreManager.js"></script>
    <script src="src/js/scoreUI.js"></script>
    <script src="src/js/loginManager.js"></script>
    <script src="src/js/firebaseSync.js"></script>
    <script type="module" src="src/js/app.js"></script>
  </body>
</html>
